2025-05-11 19:05:26,734 - __main__ - INFO - Starting newsletter automation process
2025-05-11 19:05:26,734 - __main__ - INFO - Processing newsletter for date: 2025-05-11
2025-05-11 19:05:26,734 - __main__ - INFO - Running newsletter generation...
2025-05-11 19:05:27,317 - __main__ - INFO - [newsletter generation] 
2025-05-11 19:05:27,317 - __main__ - INFO - [newsletter generation] Found 57 articles from visir for 2025-05-11
2025-05-11 19:06:54,497 - __main__ - INFO - [newsletter generation] 
2025-05-11 19:06:54,498 - __main__ - INFO - [newsletter generation] Total articles processed: 55
2025-05-11 19:06:54,498 - __main__ - INFO - [newsletter generation] 
2025-05-11 19:06:54,498 - __main__ - INFO - [newsletter generation] Found 65 articles from mbl for 2025-05-11
2025-05-11 19:08:32,021 - __main__ - INFO - [newsletter generation] Error fetching article content from https://www.mbl.is/frettir/innlent/2025/05/11/hlyrra_loft_saekir_ad_landinu/: 502 Server Error: Proxy Error for url: https://www.mbl.is/frettir/innlent/2025/05/11/hlyrra_loft_saekir_ad_landinu/
2025-05-11 19:08:32,022 - __main__ - INFO - [newsletter generation] 
2025-05-11 19:08:32,022 - __main__ - INFO - [newsletter generation] Total articles processed: 64
2025-05-11 19:08:32,022 - __main__ - INFO - [newsletter generation] 
2025-05-11 19:08:32,022 - __main__ - INFO - [newsletter generation] Found 11 articles from vb for 2025-05-11
2025-05-11 19:08:50,962 - __main__ - INFO - [newsletter generation] 
2025-05-11 19:08:50,962 - __main__ - INFO - [newsletter generation] Total articles processed: 11
2025-05-11 19:08:50,962 - __main__ - INFO - [newsletter generation] 
2025-05-11 19:08:50,962 - __main__ - INFO - [newsletter generation] Found 29 articles from ruv for 2025-05-11
2025-05-11 19:10:20,987 - __main__ - INFO - [newsletter generation] 
2025-05-11 19:10:21,486 - __main__ - INFO - [newsletter generation] Total articles processed: 27
2025-05-11 19:10:49,440 - __main__ - ERROR - [newsletter generation] Error: 2025-05-11 19:05:27,170 - INFO - Starting new run. Log file: logs/newsletter_20250511_190527.log
2025-05-11 19:05:27,172 - INFO - Starting news scraping...
2025-05-11 19:05:27,172 - INFO - Processing articles from visir...

Processing articles:   0%|          | 0/57 [00:00<?, ?article/s]
Processing articles:   2%|▏         | 1/57 [00:01<01:02,  1.12s/article]
Processing articles:   4%|▎         | 2/57 [00:02<01:03,  1.15s/article]
Processing articles:   5%|▌         | 3/57 [00:03<01:03,  1.18s/article]
Processing articles:   7%|▋         | 4/57 [00:03<00:41,  1.29article/s]
Processing articles:   9%|▉         | 5/57 [00:04<00:47,  1.08article/s]
Processing articles:  11%|█         | 6/57 [00:06<00:51,  1.01s/article]
Processing articles:  12%|█▏        | 7/57 [00:07<00:53,  1.06s/article]
Processing articles:  14%|█▍        | 8/57 [00:08<00:54,  1.11s/article]
Processing articles:  16%|█▌        | 9/57 [00:09<00:54,  1.14s/article]
Processing articles:  18%|█▊        | 10/57 [00:10<00:54,  1.17s/article]
Processing articles:  19%|█▉        | 11/57 [00:12<00:54,  1.19s/article]
Processing articles:  21%|██        | 12/57 [00:13<00:53,  1.19s/article]
Processing articles:  23%|██▎       | 13/57 [00:13<00:39,  1.13article/s]
Processing articles:  25%|██▍       | 14/57 [00:14<00:41,  1.04article/s]
Processing articles:  26%|██▋       | 15/57 [00:15<00:43,  1.03s/article]
Processing articles:  28%|██▊       | 16/57 [00:17<00:45,  1.11s/article]
Processing articles:  30%|██▉       | 17/57 [00:18<00:44,  1.12s/article]
Processing articles:  32%|███▏      | 18/57 [00:19<00:44,  1.14s/article]
Processing articles:  33%|███▎      | 19/57 [00:20<00:43,  1.15s/article]
Processing articles:  35%|███▌      | 20/57 [00:21<00:42,  1.15s/article]
Processing articles:  37%|███▋      | 21/57 [00:22<00:41,  1.15s/article]
Processing articles:  39%|███▊      | 22/57 [00:24<00:40,  1.17s/article]
Processing articles:  40%|████      | 23/57 [00:25<00:40,  1.18s/article]
Processing articles:  42%|████▏     | 24/57 [00:26<00:40,  1.23s/article]
Processing articles:  44%|████▍     | 25/57 [00:27<00:39,  1.23s/article]
Processing articles:  46%|████▌     | 26/57 [00:29<00:39,  1.26s/article]
Processing articles:  47%|████▋     | 27/57 [00:30<00:36,  1.23s/article]
Processing articles:  49%|████▉     | 28/57 [00:31<00:35,  1.22s/article]
Processing articles:  51%|█████     | 29/57 [00:32<00:34,  1.25s/article]
Processing articles:  53%|█████▎    | 30/57 [00:34<00:33,  1.24s/article]
Processing articles:  54%|█████▍    | 31/57 [00:35<00:31,  1.22s/article]
Processing articles:  56%|█████▌    | 32/57 [00:36<00:30,  1.23s/article]
Processing articles:  58%|█████▊    | 33/57 [00:37<00:29,  1.23s/article]
Processing articles:  60%|█████▉    | 34/57 [00:39<00:28,  1.23s/article]
Processing articles:  61%|██████▏   | 35/57 [00:40<00:27,  1.26s/article]
Processing articles:  63%|██████▎   | 36/57 [00:41<00:25,  1.24s/article]
Processing articles:  65%|██████▍   | 37/57 [00:42<00:24,  1.22s/article]
Processing articles:  67%|██████▋   | 38/57 [00:43<00:23,  1.21s/article]
Processing articles:  68%|██████▊   | 39/57 [00:45<00:21,  1.21s/article]
Processing articles:  70%|███████   | 40/57 [00:46<00:20,  1.24s/article]
Processing articles:  72%|███████▏  | 41/57 [00:47<00:19,  1.24s/article]
Processing articles:  74%|███████▎  | 42/57 [00:48<00:18,  1.23s/article]
Processing articles:  75%|███████▌  | 43/57 [00:50<00:17,  1.22s/article]
Processing articles:  77%|███████▋  | 44/57 [00:51<00:15,  1.21s/article]
Processing articles:  79%|███████▉  | 45/57 [00:52<00:14,  1.20s/article]
Processing articles:  81%|████████  | 46/57 [00:53<00:13,  1.20s/article]
Processing articles:  82%|████████▏ | 47/57 [00:54<00:12,  1.24s/article]
Processing articles:  84%|████████▍ | 48/57 [00:56<00:10,  1.22s/article]
Processing articles:  86%|████████▌ | 49/57 [00:57<00:09,  1.22s/article]
Processing articles:  88%|████████▊ | 50/57 [00:58<00:08,  1.21s/article]
Processing articles:  89%|████████▉ | 51/57 [00:59<00:07,  1.20s/article]
Processing articles:  91%|█████████ | 52/57 [01:00<00:05,  1.19s/article]
Processing articles:  93%|█████████▎| 53/57 [01:02<00:05,  1.26s/article]
Processing articles:  95%|█████████▍| 54/57 [01:03<00:03,  1.24s/article]
Processing articles:  96%|█████████▋| 55/57 [01:04<00:02,  1.24s/article]
Processing articles:  98%|█████████▊| 56/57 [01:05<00:01,  1.22s/article]
Processing articles: 100%|██████████| 57/57 [01:07<00:00,  1.20s/article]
Processing articles: 100%|██████████| 57/57 [01:07<00:00,  1.18s/article]
2025-05-11 19:06:34,384 - INFO - Processed 55 articles from visir
2025-05-11 19:06:34,385 - INFO - Processing articles from mbl...

Processing articles:   0%|          | 0/65 [00:00<?, ?article/s]
Processing articles:   2%|▏         | 1/65 [00:01<01:15,  1.18s/article]
Processing articles:   3%|▎         | 2/65 [00:02<01:14,  1.18s/article]
Processing articles:   5%|▍         | 3/65 [00:03<01:10,  1.15s/article]
Processing articles:   6%|▌         | 4/65 [00:04<01:09,  1.13s/article]
Processing articles:   8%|▊         | 5/65 [00:05<01:07,  1.12s/article]
Processing articles:   9%|▉         | 6/65 [00:06<01:05,  1.12s/article]
Processing articles:  11%|█         | 7/65 [00:07<01:04,  1.12s/article]
Processing articles:  12%|█▏        | 8/65 [00:09<01:03,  1.12s/article]
Processing articles:  14%|█▍        | 9/65 [00:10<01:03,  1.13s/article]
Processing articles:  15%|█▌        | 10/65 [00:11<01:01,  1.12s/article]
Processing articles:  17%|█▋        | 11/65 [00:12<01:00,  1.12s/article]
Processing articles:  18%|█▊        | 12/65 [00:13<00:59,  1.12s/article]
Processing articles:  20%|██        | 13/65 [00:14<00:58,  1.12s/article]
Processing articles:  22%|██▏       | 14/65 [00:15<00:57,  1.13s/article]
Processing articles:  23%|██▎       | 15/65 [00:16<00:57,  1.14s/article]
Processing articles:  26%|██▌       | 17/65 [00:18<00:42,  1.14article/s]
Processing articles:  28%|██▊       | 18/65 [00:19<00:44,  1.06article/s]
Processing articles:  29%|██▉       | 19/65 [00:20<00:45,  1.00article/s]
Processing articles:  31%|███       | 20/65 [00:23<01:07,  1.49s/article]
Processing articles:  32%|███▏      | 21/65 [00:24<01:00,  1.38s/article]
Processing articles:  34%|███▍      | 22/65 [00:25<00:56,  1.31s/article]
Processing articles:  35%|███▌      | 23/65 [00:29<01:22,  1.97s/article]
Processing articles:  37%|███▋      | 24/65 [00:30<01:10,  1.72s/article]
Processing articles:  38%|███▊      | 25/65 [00:31<01:01,  1.55s/article]
Processing articles:  40%|████      | 26/65 [00:32<00:55,  1.42s/article]
Processing articles:  42%|████▏     | 27/65 [00:33<00:50,  1.32s/article]
Processing articles:  43%|████▎     | 28/65 [00:34<00:46,  1.25s/article]
Processing articles:  45%|████▍     | 29/65 [00:35<00:44,  1.24s/article]
Processing articles:  46%|████▌     | 30/65 [00:36<00:41,  1.19s/article]
Processing articles:  48%|████▊     | 31/65 [00:37<00:39,  1.16s/article]
Processing articles:  49%|████▉     | 32/65 [00:39<00:37,  1.14s/article]
Processing articles:  51%|█████     | 33/65 [00:40<00:36,  1.15s/article]
Processing articles:  52%|█████▏    | 34/65 [00:41<00:35,  1.14s/article]
Processing articles:  54%|█████▍    | 35/65 [00:42<00:34,  1.13s/article]
Processing articles:  55%|█████▌    | 36/65 [00:43<00:32,  1.13s/article]
Processing articles:  57%|█████▋    | 37/65 [00:44<00:31,  1.13s/article]
Processing articles:  58%|█████▊    | 38/65 [00:47<00:42,  1.58s/article]
Processing articles:  60%|██████    | 39/65 [00:48<00:37,  1.43s/article]
Processing articles:  62%|██████▏   | 40/65 [00:49<00:33,  1.33s/article]
Processing articles:  63%|██████▎   | 41/65 [00:50<00:30,  1.29s/article]
Processing articles:  65%|██████▍   | 42/65 [00:51<00:28,  1.24s/article]
Processing articles:  66%|██████▌   | 43/65 [00:52<00:26,  1.20s/article]
Processing articles:  68%|██████▊   | 44/65 [00:54<00:24,  1.17s/article]
Processing articles:  69%|██████▉   | 45/65 [00:56<00:32,  1.64s/article]
Processing articles:  71%|███████   | 46/65 [00:59<00:35,  1.89s/article]
Processing articles:  72%|███████▏  | 47/65 [01:00<00:29,  1.65s/article]
Processing articles:  74%|███████▍  | 48/65 [01:02<00:32,  1.92s/article]
Processing articles:  75%|███████▌  | 49/65 [01:06<00:37,  2.36s/article]
Processing articles:  77%|███████▋  | 50/65 [01:08<00:36,  2.44s/article]
Processing articles:  78%|███████▊  | 51/65 [01:11<00:35,  2.51s/article]
Processing articles:  80%|████████  | 52/65 [01:12<00:27,  2.09s/article]
Processing articles:  82%|████████▏ | 53/65 [01:15<00:26,  2.24s/article]
Processing articles:  83%|████████▎ | 54/65 [01:16<00:20,  1.90s/article]
Processing articles:  85%|████████▍ | 55/65 [01:19<00:22,  2.21s/article]
Processing articles:  86%|████████▌ | 56/65 [01:21<00:19,  2.15s/article]
Processing articles:  88%|████████▊ | 57/65 [01:24<00:19,  2.43s/article]
Processing articles:  89%|████████▉ | 58/65 [01:25<00:14,  2.06s/article]
Processing articles:  91%|█████████ | 59/65 [01:26<00:10,  1.78s/article]
Processing articles:  92%|█████████▏| 60/65 [01:27<00:07,  1.58s/article]
Processing articles:  94%|█████████▍| 61/65 [01:28<00:05,  1.43s/article]
Processing articles:  95%|█████████▌| 62/65 [01:32<00:06,  2.08s/article]
Processing articles:  97%|█████████▋| 63/65 [01:33<00:03,  1.80s/article]
Processing articles:  98%|█████████▊| 64/65 [01:34<00:01,  1.60s/article]
Processing articles: 100%|██████████| 65/65 [01:35<00:00,  1.47s/article]
Processing articles: 100%|██████████| 65/65 [01:35<00:00,  1.48s/article]
2025-05-11 19:08:30,451 - INFO - Processed 64 articles from mbl
2025-05-11 19:08:30,451 - INFO - Processing articles from vb...

Processing articles:   0%|          | 0/11 [00:00<?, ?article/s]
Processing articles:   9%|▉         | 1/11 [00:01<00:14,  1.49s/article]
Processing articles:  18%|█▊        | 2/11 [00:02<00:12,  1.43s/article]
Processing articles:  27%|██▋       | 3/11 [00:04<00:11,  1.45s/article]
Processing articles:  36%|███▋      | 4/11 [00:05<00:10,  1.43s/article]
Processing articles:  45%|████▌     | 5/11 [00:07<00:08,  1.41s/article]
Processing articles:  55%|█████▍    | 6/11 [00:11<00:12,  2.49s/article]
Processing articles:  64%|██████▎   | 7/11 [00:13<00:08,  2.13s/article]
Processing articles:  73%|███████▎  | 8/11 [00:14<00:05,  1.89s/article]
Processing articles:  82%|████████▏ | 9/11 [00:15<00:03,  1.75s/article]
Processing articles:  91%|█████████ | 10/11 [00:17<00:01,  1.62s/article]
Processing articles: 100%|██████████| 11/11 [00:18<00:00,  1.55s/article]
Processing articles: 100%|██████████| 11/11 [00:18<00:00,  1.69s/article]
2025-05-11 19:08:50,662 - INFO - Processed 11 articles from vb
2025-05-11 19:08:50,662 - INFO - Processing articles from ruv...

Processing articles:   0%|          | 0/29 [00:00<?, ?article/s]
Processing articles:   3%|▎         | 1/29 [00:01<00:39,  1.43s/article]
Processing articles:   7%|▋         | 2/29 [00:02<00:37,  1.38s/article]
Processing articles:  10%|█         | 3/29 [00:04<00:35,  1.35s/article]
Processing articles:  14%|█▍        | 4/29 [00:05<00:34,  1.37s/article]
Processing articles:  17%|█▋        | 5/29 [00:06<00:32,  1.34s/article]
Processing articles:  21%|██        | 6/29 [00:08<00:30,  1.33s/article]
Processing articles:  24%|██▍       | 7/29 [00:09<00:28,  1.32s/article]
Processing articles:  28%|██▊       | 8/29 [00:10<00:28,  1.34s/article]
Processing articles:  31%|███       | 9/29 [00:12<00:26,  1.34s/article]
Processing articles:  34%|███▍      | 10/29 [00:13<00:25,  1.33s/article]
Processing articles:  38%|███▊      | 11/29 [00:14<00:24,  1.35s/article]
Processing articles:  41%|████▏     | 12/29 [00:16<00:22,  1.33s/article]
Processing articles:  45%|████▍     | 13/29 [00:17<00:21,  1.34s/article]
Processing articles:  48%|████▊     | 14/29 [00:18<00:19,  1.32s/article]
Processing articles:  52%|█████▏    | 15/29 [00:20<00:18,  1.35s/article]
Processing articles:  55%|█████▌    | 16/29 [00:20<00:13,  1.07s/article]
Processing articles:  59%|█████▊    | 17/29 [00:21<00:13,  1.14s/article]
Processing articles:  62%|██████▏   | 18/29 [00:22<00:10,  1.08article/s]
Processing articles:  66%|██████▌   | 19/29 [00:23<00:10,  1.04s/article]
Processing articles:  69%|██████▉   | 20/29 [00:25<00:10,  1.16s/article]
Processing articles:  72%|███████▏  | 21/29 [00:26<00:09,  1.24s/article]
Processing articles:  76%|███████▌  | 22/29 [00:27<00:09,  1.29s/article]
Processing articles:  79%|███████▉  | 23/29 [00:29<00:07,  1.30s/article]
Processing articles:  83%|████████▎ | 24/29 [00:30<00:06,  1.33s/article]
Processing articles:  86%|████████▌ | 25/29 [00:31<00:05,  1.32s/article]
Processing articles:  90%|████████▉ | 26/29 [00:33<00:03,  1.33s/article]
Processing articles:  93%|█████████▎| 27/29 [00:34<00:02,  1.38s/article]
Processing articles:  97%|█████████▋| 28/29 [00:35<00:01,  1.34s/article]
Processing articles: 100%|██████████| 29/29 [00:37<00:00,  1.32s/article]
Processing articles: 100%|██████████| 29/29 [00:37<00:00,  1.28s/article]
2025-05-11 19:09:28,206 - INFO - Processed 27 articles from ruv
2025-05-11 19:09:28,220 - INFO - Saved 157 total articles to outputs/news/json/news_articles_2025-05-11.json
2025-05-11 19:09:28,221 - INFO - Starting newsletter generation...
2025-05-11 19:09:28,221 - INFO - Generating daily_morning newsletter...
2025-05-11 19:09:28,428 - INFO - Estimated prompt tokens: 204398
2025-05-11 19:10:15,642 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-11 19:10:16,280 - INFO - Completion tokens: 6609
2025-05-11 19:10:16,285 - INFO - Total tokens used: 157479
2025-05-11 19:10:16,374 - INFO - daily_morning newsletter saved to: outputs/newsletters/daily_morning/daily_morning_2025-05-11.json
2025-05-11 19:10:16,576 - INFO - Starting newsletter formatting...
2025-05-11 19:10:16,578 - INFO - Formatting daily_morning newsletter...
2025-05-11 19:10:16,902 - INFO - Found keys in newsletter content: ['date', 'main_headline', 'summary', 'key_events', 'domestic_news', 'foreign_news', 'business', 'famous_people', 'sports', 'arts', 'science', 'closing_summary']
2025-05-11 19:10:17,388 - INFO - Formatted newsletter saved to: outputs/formatted_newsletters/daily_morning/daily_morning_2025-05-11.html
2025-05-11 19:10:49,446 - __main__ - INFO - newsletter generation completed successfully
2025-05-11 19:10:49,450 - __main__ - INFO - Running newsletter sending...
2025-05-11 19:10:49,654 - __main__ - ERROR - [newsletter sending] Error: usage: send_newsletter.py [-h] [--date DATE] [--file FILE]
send_newsletter.py: error: unrecognized arguments: --type daily_morning
2025-05-11 19:10:49,654 - __main__ - ERROR - newsletter sending failed with return code 2
2025-05-11 19:10:49,655 - __main__ - ERROR - Newsletter sending failed.
